# 22BCE20122


CREATE TABLE DEPARTMENT (
    DEPARTMENT_ID INT PRIMARY KEY,
    DEPARTMENT_NAME VARCHAR(100) NOT NULL
);

CREATE TABLE EMPLOYEE (
    EMP_ID INT PRIMARY KEY,
    FIRST_NAME VARCHAR(100) NOT NULL,
    LAST_NAME VARCHAR(100) NOT NULL,
    DOB DATE NOT NULL,
    GENDER VARCHAR(10),
    DEPARTMENT_ID INT,
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENT(DEPARTMENT_ID)
);
INSERT INTO DEPARTMENT (DEPARTMENT_ID, DEPARTMENT_NAME) VALUES
(1, 'HR'),
(2, 'Finance'),
(3, 'Engineering'),
(4, 'Sales'),
(5, 'Marketing'),
(6, 'IT');

INSERT INTO EMPLOYEE (EMP_ID, FIRST_NAME, LAST_NAME, DOB, GENDER, DEPARTMENT_ID) VALUES
(1, 'John',   'Williams',  '1980-05-15', 'Male',   3),
(2, 'Sarah',  'Johnson',   '1990-07-20', 'Female', 2),
(3, 'Michael','Smith',     '1985-02-10', 'Male',   3),
(4, 'Emily',  'Brown',     '1992-11-30', 'Female', 4),
(5, 'David',  'Jones',     '1988-09-05', 'Male',   5),
(6, 'Olivia', 'Davis',     '1995-04-12', 'Female', 1),
(7, 'James',  'Wilson',    '1983-03-25', 'Male',   6),
(8, 'Sophia', 'Anderson',  '1991-08-17', 'Female', 4),
(9, 'Liam',   'Miller',    '1979-12-01', 'Male',   1),
(10,'Emma',   'Taylor',    '1993-06-28', 'Female', 5);


SELECT 
    E1.EMP_ID,
    E1.FIRST_NAME,
    E1.LAST_NAME,
    D.DEPARTMENT_NAME,
    COUNT(E2.EMP_ID) AS YOUNGER_EMPLOYEES_COUNT
FROM EMPLOYEE E1
JOIN DEPARTMENT D 
    ON E1.DEPARTMENT_ID = D.DEPARTMENT_ID
LEFT JOIN EMPLOYEE E2 
    ON E1.DEPARTMENT_ID = E2.DEPARTMENT_ID
   AND E2.DOB > E1.DOB
GROUP BY 
    E1.EMP_ID, 
    E1.FIRST_NAME, 
    E1.LAST_NAME, 
    D.DEPARTMENT_NAME
ORDER BY 
    E1.EMP_ID DESC;
